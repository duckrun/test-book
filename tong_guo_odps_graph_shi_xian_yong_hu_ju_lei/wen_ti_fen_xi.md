## 问题分析

在推荐领域，该问题属于基于用户的协同过滤范畴，它主要包括两个步骤：一是找到和目标用户兴趣度相近的用户集合；二是给目标用户推荐该集合中其他用户感兴趣（而目标用户没听过）的item。

对用户聚类即构建兴趣度相近的用户集合，常见的一种方式是通过Kmeans算法来实现。假定要把样本划分为k个类别，Kmeans算法的计算过程如下：

1.  选择k个初始中心节点；
2.  在每次迭代中，对每个样本，计算其到中心节点的距离；
3.  更新中心节点
4.  如果中心节点不变（或小于阈值），迭代结束；否则继续步骤2）、3）迭代

Kmeans算法的优势在于简洁快速，其关键在于初始中心节点的选择和距离公式。

在这个示例中，首先应该对数据进行预处理，构造用户的特征向量。出于简单，这里选择10个最hot的品牌（构造次数最多），基于用户对这10个品牌的购买次数，构造特征如下：

user_id, cnt1, …, cnt10，其中cnt表示对应品牌的购买次数。

然后通过ODPS Graph编程框架，通过KMeans算法实现聚类。